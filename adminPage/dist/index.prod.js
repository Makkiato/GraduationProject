"use strict";var app=require("express")(),http=require("http"),httpserver=http.createServer(app),io=require("socket.io")(httpserver),config=require("./config.js");function getFromCB(e,n){var o="";e.on("data",function(e){o+=e}),e.on("end",function(){console.log("received server data:"),console.log(o),n(o)})}app.engine("pug",require("pug").__express),app.set("view engine","pug"),app.locals.pretty=!0,app.get("/",function(e,n){n.status(200).send("OK : 200")}),app.get("/main",function(e,n){var o=config.orionCB;o.path="/v2/entities?type=led",http.request(o,function(e){console.log(o),getFromCB(e,function(e){console.log("fiware data\n"+e),n.render(__dirname+"/adminMain.pug",{data:JSON.stringify(JSON.parse(e))})})}).end()}),io.on("connection",function(n){console.log("socket on!"),n.on("change",function(e){console.log(e),n.emit("done",null)})}),httpserver.listen(7777,function(){console.log("localhost:7777")});